"use strict";const Z=require("electron"),R=require("path"),lt=require("fs"),Yt=require("constants"),Gt=require("stream"),Kt=require("util"),Qt=require("assert"),{ipcMain:be,BrowserWindow:Ee}=require("electron"),Xt=()=>{be.on("window-min",e=>{const t=e.sender;Ee.fromWebContents(t).minimize()}),be.on("window-max",e=>{const t=e.sender,n=Ee.fromWebContents(t);n.isMaximized()?n.unmaximize():n.maximize()}),be.on("window-close",e=>{const t=e.sender;Ee.fromWebContents(t).close()})},Zt=require("path"),_e=class q{constructor(){this.getWindowById=t=>Z.BrowserWindow.fromId(t),this.defaultConfig={id:null,title:"",width:null,height:null,minWidth:null,minHeight:null,route:"",resizable:!0,maximize:!1,backgroundColor:"#eee",data:null,isMultiWindow:!1,isMainWin:!1,parentId:null,modal:!0},this.defaultOptions={width:900,height:700,center:!0,frame:!1,show:!0,transparent:!0,maxWidth:null,maxHeight:null,minWidth:680,minHeight:500,backgroundColor:"rgba(0,0,0,0)",autoHideMenuBar:!0,resizable:!0,minimizable:!0,maximizable:!0,modal:!0,parent:null,webPreferences:{contextIsolation:!0,webSecurity:!1,nodeIntegration:!0,preload:Zt.join(__dirname,"../preload/preload.js")}}}createWindow(t,n){var l;let i=0;if(q.group.some((c,m)=>(i=m,c.route===t.route))){console.info("window is already created"),(l=this.getWindowById(i+1))==null||l.blur();return}let r=Object.assign({},this.defaultConfig,t),o=Object.assign({},this.defaultOptions,n);!r.isMainWin&&q.main&&(o.parent=q.main);let a=new Z.BrowserWindow(o);console.log("window id:"+a.id),q.group[a.id-1]={windowId:a.id,route:r.route},r.maximize&&r.resizable&&a.maximize(),r.isMainWin&&(q.main&&(console.info("main window already created"),delete q.group[0],q.main.close()),q.main=a);let s=this;a.on("close",()=>{q.group.forEach((c,m)=>{this.getWindowById(c.windowId)==a&&delete q.group[m],a==s.main&&Z.app.quit()}),a.setOpacity(0)});let u;return Z.app.isPackaged?a.loadFile(R.join(__dirname,"../../dist/index.html"),{hash:r.route}):(u=r.route?`http://localhost:${process.env.VITE_DEV_SERVER_PORT}/#${r.route}`:`http://localhost:${process.env.VITE_DEV_SERVER_PORT}/#`,a.loadURL(u)),console.info("new window address -> ",u),a.setMenu(null),Z.globalShortcut.register("CommandOrControl+Shift+i",function(){a.webContents.openDevTools()}),a.once("ready-to-show",()=>{a.show()}),a}};_e.group=[];_e.main=null;let ft=_e;const en=require("sharp"),w=class{};w.generate=async(e,t,n)=>{w.configArray=n,w.threshold=t;const i=await w.base64ToImageData(e),r=w.imageDataToHexArray(i);return w.configArray[3]==0?w.hex2hex(r.toString("hex")):r};w.imageDataToHexArray=e=>{const t=w.createImageData(e);let n=t.data,i=t.height,r=t.width,o=n.length;if(w.configArray[4]==1){let a=w.threshold,s=[],u=4,l;for(let c=0;c<o;c+=u)l=n[c+1]=n[c+2]=n[c],l>a?l=1:l=0,s[c/u]=l;return w.imageSamplingArr[w.configArray[1]](s,r,i)}else return w.colorImageSampling(n,r,i)};w.colorImageSampling=(e,t,n)=>{const i=Buffer.alloc(t*n*2);let r=0,o=0;for(;r<i.length&&o<e.length;)i[r]|=e[o]>>3<<3,i[r]|=e[o+1]>>5,i[r+1]|=e[o+1]>>2<<5,i[r+1]|=e[o+2]>>3,(w.configArray[0]==0||w.configArray[2]==1)&&(i[r]=~i[r],i[r+1]=~i[r+1]),r+=2,o+=4;return i};w.ImageSamplingRow=(e,t,n)=>{const i=Buffer.alloc(t*n/8);for(let r=0;r<e.length;r++){let o=Math.floor(r%t),a=Math.floor(r/t),s=0,u=a,l=1<<o%8;w.configArray[2]!=0&&(l=1<<7-o%8),s=u*Math.floor(t/8)+Math.floor(o/8),w.configArray[0]!==0&&(e[r]===0?e[r]=1:e[r]=0),e[r]===0?i[s]|=l:i[s]&=~l}return i};w.ImageSamplingCol=(e,t,n)=>{const i=Buffer.alloc(t*n/8);for(let r=0;r<e.length;r++){let o=Math.floor(r%t),a=Math.floor(r/t),s=0,u=o,l=1<<a%8;w.configArray[2]!=0&&(l=1<<7-a%8),s=u*Math.floor(n/8)+Math.floor(a/8),w.configArray[0]!==0&&(e[r]===0?e[r]=1:e[r]=0),e[r]===0?i[s]|=l:i[s]&=~l}return i};w.ImageSamplingColRow=(e,t,n)=>{const i=Buffer.alloc(t*n/8);for(let r=0;r<e.length;r++){let o=Math.floor(r%t),a=Math.floor(r/t),s=0,u=Math.floor(a/8),l=1<<a-8*u;w.configArray[2]!=0&&(l=1<<7-(a-8*u)),u===0?s=o:s=o+t*u,w.configArray[0]!==0&&(e[r]===0?e[r]=1:e[r]=0),e[r]===0?i[s]|=l:i[s]&=~l}return i};w.ImageSamplingRowCol=(e,t,n)=>{const i=Buffer.alloc(t*n/8);for(let r=0;r<e.length;r++){let o=Math.floor(r%t),a=Math.floor(r/t),s=0,u=Math.floor(o/8),l=1<<o%8;w.configArray[2]!=0&&(l=1<<7-o%8),s=u*n+a,w.configArray[0]!==0&&(e[r]===0?e[r]=1:e[r]=0),e[r]===0?i[s]|=l:i[s]&=~l}return i};w.imageSamplingArr=[w.ImageSamplingRow,w.ImageSamplingCol,w.ImageSamplingColRow,w.ImageSamplingRowCol];w.createImageData=e=>{let t=Buffer.alloc(e.width*e.height*4);for(let n=0,i=0;n<e.height;n++)for(let r=0;r<e.width;r++)t.writeUInt32BE(w.getPixel(e,r,n),i),i+=4;return e.data=t,e};w.getPixel=(e,t,n)=>{if(t=t|0,n=n|0,t<0||n<0||t>=e.width||n>=e.height)return 0;let i=(n*e.width+t)*e.channels,r,o,a,s;switch(e.channels){case 1:r=o=a=e.data[i],s=255;break;case 2:r=o=a=e.data[i],s=e.data[i+1];break;case 3:r=e.data[i],o=e.data[i+1],a=e.data[i+2],s=255;break;case 4:r=e.data[i],o=e.data[i+1],a=e.data[i+2],s=e.data[i+3];break}return(r<<24|o<<16|a<<8|s)>>>0};w.bufferToImageData=async e=>{const{data:t,info:n}=await en(e).raw().ensureAlpha().toBuffer({resolveWithObject:!0}),i=n.channels;return{width:n.width,height:n.height,data:new Uint8ClampedArray(t),channels:i}};w.base64ToImageData=async e=>{const t=Buffer.from(e.replace(/^data:image\/\w+;base64,/,""),"base64");return await w.bufferToImageData(t)};w.hex2hex=e=>{for(var t=[],n=0;n<e.length;n+=2)t.push("0x"+e.substr(n,2));return t};let mt=w;const{ipcMain:ze}=require("electron"),He=require("sharp"),tn=require("crypto"),nn=require("os"),rn=require("fs-extra"),on=require("path"),an=async(e,t,n,i)=>{if(e==0||t==0)return;let r=tn.createHash("md5").update("angular-cir-img").digest("hex")+".bmp",o=on.join(nn.tmpdir(),r),a=Buffer.from(n.replace(/^data:image\/\w+;base64,/,""),"base64");return await rn.writeFile(o,a),new Promise((s,u)=>{i?He(o).resize(e,t).greyscale().toBuffer().then(l=>{s(l.toString("base64"))}):He(o).resize(e,t).toBuffer().then(l=>{s(l.toString("base64"))})})},cn=()=>{ze.handle("pic-data-editor",async(e,t,n,i,r)=>await an(t,n,i,r)),ze.handle("pic-data-parse",async(e,t,n,...i)=>await mt.generate(t,n,i))},sn=require("electron-store"),Te=new sn,un=(e,t)=>{Te.set(e,t)},ln=e=>Te.get(e),fn=e=>{Te.delete(e)};var xe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},j={},O={};O.fromCallback=function(e){return Object.defineProperty(function(...t){if(typeof t[t.length-1]=="function")e.apply(this,t);else return new Promise((n,i)=>{t.push((r,o)=>r!=null?i(r):n(o)),e.apply(this,t)})},"name",{value:e.name})};O.fromPromise=function(e){return Object.defineProperty(function(...t){const n=t[t.length-1];if(typeof n!="function")return e.apply(this,t);t.pop(),e.apply(this,t).then(i=>n(null,i),n)},"name",{value:e.name})};var z=Yt,mn=process.cwd,we=null,yn=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return we||(we=mn.call(process)),we};try{process.cwd()}catch{}if(typeof process.chdir=="function"){var Ve=process.chdir;process.chdir=function(e){we=null,Ve.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,Ve)}var dn=hn;function hn(e){z.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&t(e),e.lutimes||n(e),e.chown=o(e.chown),e.fchown=o(e.fchown),e.lchown=o(e.lchown),e.chmod=i(e.chmod),e.fchmod=i(e.fchmod),e.lchmod=i(e.lchmod),e.chownSync=a(e.chownSync),e.fchownSync=a(e.fchownSync),e.lchownSync=a(e.lchownSync),e.chmodSync=r(e.chmodSync),e.fchmodSync=r(e.fchmodSync),e.lchmodSync=r(e.lchmodSync),e.stat=s(e.stat),e.fstat=s(e.fstat),e.lstat=s(e.lstat),e.statSync=u(e.statSync),e.fstatSync=u(e.fstatSync),e.lstatSync=u(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(c,m,y){y&&process.nextTick(y)},e.lchmodSync=function(){}),e.chown&&!e.lchown&&(e.lchown=function(c,m,y,f){f&&process.nextTick(f)},e.lchownSync=function(){}),yn==="win32"&&(e.rename=typeof e.rename!="function"?e.rename:function(c){function m(y,f,d){var g=Date.now(),S=0;c(y,f,function E(A){if(A&&(A.code==="EACCES"||A.code==="EPERM"||A.code==="EBUSY")&&Date.now()-g<6e4){setTimeout(function(){e.stat(f,function(N,oe){N&&N.code==="ENOENT"?c(y,f,E):d(A)})},S),S<100&&(S+=10);return}d&&d(A)})}return Object.setPrototypeOf&&Object.setPrototypeOf(m,c),m}(e.rename)),e.read=typeof e.read!="function"?e.read:function(c){function m(y,f,d,g,S,E){var A;if(E&&typeof E=="function"){var N=0;A=function(oe,Je,Ue){if(oe&&oe.code==="EAGAIN"&&N<10)return N++,c.call(e,y,f,d,g,S,A);E.apply(this,arguments)}}return c.call(e,y,f,d,g,S,A)}return Object.setPrototypeOf&&Object.setPrototypeOf(m,c),m}(e.read),e.readSync=typeof e.readSync!="function"?e.readSync:function(c){return function(m,y,f,d,g){for(var S=0;;)try{return c.call(e,m,y,f,d,g)}catch(E){if(E.code==="EAGAIN"&&S<10){S++;continue}throw E}}}(e.readSync);function t(c){c.lchmod=function(m,y,f){c.open(m,z.O_WRONLY|z.O_SYMLINK,y,function(d,g){if(d){f&&f(d);return}c.fchmod(g,y,function(S){c.close(g,function(E){f&&f(S||E)})})})},c.lchmodSync=function(m,y){var f=c.openSync(m,z.O_WRONLY|z.O_SYMLINK,y),d=!0,g;try{g=c.fchmodSync(f,y),d=!1}finally{if(d)try{c.closeSync(f)}catch{}else c.closeSync(f)}return g}}function n(c){z.hasOwnProperty("O_SYMLINK")&&c.futimes?(c.lutimes=function(m,y,f,d){c.open(m,z.O_SYMLINK,function(g,S){if(g){d&&d(g);return}c.futimes(S,y,f,function(E){c.close(S,function(A){d&&d(E||A)})})})},c.lutimesSync=function(m,y,f){var d=c.openSync(m,z.O_SYMLINK),g,S=!0;try{g=c.futimesSync(d,y,f),S=!1}finally{if(S)try{c.closeSync(d)}catch{}else c.closeSync(d)}return g}):c.futimes&&(c.lutimes=function(m,y,f,d){d&&process.nextTick(d)},c.lutimesSync=function(){})}function i(c){return c&&function(m,y,f){return c.call(e,m,y,function(d){l(d)&&(d=null),f&&f.apply(this,arguments)})}}function r(c){return c&&function(m,y){try{return c.call(e,m,y)}catch(f){if(!l(f))throw f}}}function o(c){return c&&function(m,y,f,d){return c.call(e,m,y,f,function(g){l(g)&&(g=null),d&&d.apply(this,arguments)})}}function a(c){return c&&function(m,y,f){try{return c.call(e,m,y,f)}catch(d){if(!l(d))throw d}}}function s(c){return c&&function(m,y,f){typeof y=="function"&&(f=y,y=null);function d(g,S){S&&(S.uid<0&&(S.uid+=4294967296),S.gid<0&&(S.gid+=4294967296)),f&&f.apply(this,arguments)}return y?c.call(e,m,y,d):c.call(e,m,d)}}function u(c){return c&&function(m,y){var f=y?c.call(e,m,y):c.call(e,m);return f&&(f.uid<0&&(f.uid+=4294967296),f.gid<0&&(f.gid+=4294967296)),f}}function l(c){if(!c||c.code==="ENOSYS")return!0;var m=!process.getuid||process.getuid()!==0;return!!(m&&(c.code==="EINVAL"||c.code==="EPERM"))}}var Ye=Gt.Stream,wn=pn;function pn(e){return{ReadStream:t,WriteStream:n};function t(i,r){if(!(this instanceof t))return new t(i,r);Ye.call(this);var o=this;this.path=i,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,r=r||{};for(var a=Object.keys(r),s=0,u=a.length;s<u;s++){var l=a[s];this[l]=r[l]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){o._read()});return}e.open(this.path,this.flags,this.mode,function(c,m){if(c){o.emit("error",c),o.readable=!1;return}o.fd=m,o.emit("open",m),o._read()})}function n(i,r){if(!(this instanceof n))return new n(i,r);Ye.call(this),this.path=i,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,r=r||{};for(var o=Object.keys(r),a=0,s=o.length;a<s;a++){var u=o[a];this[u]=r[u]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}var Sn=gn,vn=Object.getPrototypeOf||function(e){return e.__proto__};function gn(e){if(e===null||typeof e!="object")return e;if(e instanceof Object)var t={__proto__:vn(e)};else var t=Object.create(null);return Object.getOwnPropertyNames(e).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}),t}var F=lt,$n=dn,bn=wn,En=Sn,ye=Kt,T,pe;typeof Symbol=="function"&&typeof Symbol.for=="function"?(T=Symbol.for("graceful-fs.queue"),pe=Symbol.for("graceful-fs.previous")):(T="___graceful-fs.queue",pe="___graceful-fs.previous");function kn(){}function yt(e,t){Object.defineProperty(e,T,{get:function(){return t}})}var Y=kn;ye.debuglog?Y=ye.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(Y=function(){var e=ye.format.apply(ye,arguments);e="GFS4: "+e.split(/\n/).join(`
GFS4: `),console.error(e)});if(!F[T]){var Fn=xe[T]||[];yt(F,Fn),F.close=function(e){function t(n,i){return e.call(F,n,function(r){r||Ge(),typeof i=="function"&&i.apply(this,arguments)})}return Object.defineProperty(t,pe,{value:e}),t}(F.close),F.closeSync=function(e){function t(n){e.apply(F,arguments),Ge()}return Object.defineProperty(t,pe,{value:e}),t}(F.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){Y(F[T]),Qt.equal(F[T].length,0)})}xe[T]||yt(xe,F[T]);var re=We(En(F));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!F.__patched&&(re=We(F),F.__patched=!0);function We(e){$n(e),e.gracefulify=We,e.createReadStream=Je,e.createWriteStream=Ue;var t=e.readFile;e.readFile=n;function n(h,v,p){return typeof v=="function"&&(p=v,v=null),C(h,v,p);function C(I,x,k,P){return t(I,x,function($){$&&($.code==="EMFILE"||$.code==="ENFILE")?Q([C,[I,x,k],$,P||Date.now(),Date.now()]):typeof k=="function"&&k.apply(this,arguments)})}}var i=e.writeFile;e.writeFile=r;function r(h,v,p,C){return typeof p=="function"&&(C=p,p=null),I(h,v,p,C);function I(x,k,P,$,_){return i(x,k,P,function(b){b&&(b.code==="EMFILE"||b.code==="ENFILE")?Q([I,[x,k,P,$],b,_||Date.now(),Date.now()]):typeof $=="function"&&$.apply(this,arguments)})}}var o=e.appendFile;o&&(e.appendFile=a);function a(h,v,p,C){return typeof p=="function"&&(C=p,p=null),I(h,v,p,C);function I(x,k,P,$,_){return o(x,k,P,function(b){b&&(b.code==="EMFILE"||b.code==="ENFILE")?Q([I,[x,k,P,$],b,_||Date.now(),Date.now()]):typeof $=="function"&&$.apply(this,arguments)})}}var s=e.copyFile;s&&(e.copyFile=u);function u(h,v,p,C){return typeof p=="function"&&(C=p,p=0),I(h,v,p,C);function I(x,k,P,$,_){return s(x,k,P,function(b){b&&(b.code==="EMFILE"||b.code==="ENFILE")?Q([I,[x,k,P,$],b,_||Date.now(),Date.now()]):typeof $=="function"&&$.apply(this,arguments)})}}var l=e.readdir;e.readdir=m;var c=/^v[0-5]\./;function m(h,v,p){typeof v=="function"&&(p=v,v=null);var C=c.test(process.version)?function(k,P,$,_){return l(k,I(k,P,$,_))}:function(k,P,$,_){return l(k,P,I(k,P,$,_))};return C(h,v,p);function I(x,k,P,$){return function(_,b){_&&(_.code==="EMFILE"||_.code==="ENFILE")?Q([C,[x,k,P],_,$||Date.now(),Date.now()]):(b&&b.sort&&b.sort(),typeof P=="function"&&P.call(this,_,b))}}}if(process.version.substr(0,4)==="v0.8"){var y=bn(e);E=y.ReadStream,N=y.WriteStream}var f=e.ReadStream;f&&(E.prototype=Object.create(f.prototype),E.prototype.open=A);var d=e.WriteStream;d&&(N.prototype=Object.create(d.prototype),N.prototype.open=oe),Object.defineProperty(e,"ReadStream",{get:function(){return E},set:function(h){E=h},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return N},set:function(h){N=h},enumerable:!0,configurable:!0});var g=E;Object.defineProperty(e,"FileReadStream",{get:function(){return g},set:function(h){g=h},enumerable:!0,configurable:!0});var S=N;Object.defineProperty(e,"FileWriteStream",{get:function(){return S},set:function(h){S=h},enumerable:!0,configurable:!0});function E(h,v){return this instanceof E?(f.apply(this,arguments),this):E.apply(Object.create(E.prototype),arguments)}function A(){var h=this;$e(h.path,h.flags,h.mode,function(v,p){v?(h.autoClose&&h.destroy(),h.emit("error",v)):(h.fd=p,h.emit("open",p),h.read())})}function N(h,v){return this instanceof N?(d.apply(this,arguments),this):N.apply(Object.create(N.prototype),arguments)}function oe(){var h=this;$e(h.path,h.flags,h.mode,function(v,p){v?(h.destroy(),h.emit("error",v)):(h.fd=p,h.emit("open",p))})}function Je(h,v){return new e.ReadStream(h,v)}function Ue(h,v){return new e.WriteStream(h,v)}var Vt=e.open;e.open=$e;function $e(h,v,p,C){return typeof p=="function"&&(C=p,p=null),I(h,v,p,C);function I(x,k,P,$,_){return Vt(x,k,P,function(b,Hi){b&&(b.code==="EMFILE"||b.code==="ENFILE")?Q([I,[x,k,P,$],b,_||Date.now(),Date.now()]):typeof $=="function"&&$.apply(this,arguments)})}}return e}function Q(e){Y("ENQUEUE",e[0].name,e[1]),F[T].push(e),Ne()}var de;function Ge(){for(var e=Date.now(),t=0;t<F[T].length;++t)F[T][t].length>2&&(F[T][t][3]=e,F[T][t][4]=e);Ne()}function Ne(){if(clearTimeout(de),de=void 0,F[T].length!==0){var e=F[T].shift(),t=e[0],n=e[1],i=e[2],r=e[3],o=e[4];if(r===void 0)Y("RETRY",t.name,n),t.apply(null,n);else if(Date.now()-r>=6e4){Y("TIMEOUT",t.name,n);var a=n.pop();typeof a=="function"&&a.call(null,i)}else{var s=Date.now()-o,u=Math.max(o-r,1),l=Math.min(u*1.2,100);s>=l?(Y("RETRY",t.name,n),t.apply(null,n.concat([r]))):F[T].push(e)}de===void 0&&(de=setTimeout(Ne,0))}}(function(e){const t=O.fromCallback,n=re,i=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(r=>typeof n[r]=="function");Object.assign(e,n),i.forEach(r=>{e[r]=t(n[r])}),e.exists=function(r,o){return typeof o=="function"?n.exists(r,o):new Promise(a=>n.exists(r,a))},e.read=function(r,o,a,s,u,l){return typeof l=="function"?n.read(r,o,a,s,u,l):new Promise((c,m)=>{n.read(r,o,a,s,u,(y,f,d)=>{if(y)return m(y);c({bytesRead:f,buffer:d})})})},e.write=function(r,o,...a){return typeof a[a.length-1]=="function"?n.write(r,o,...a):new Promise((s,u)=>{n.write(r,o,...a,(l,c,m)=>{if(l)return u(l);s({bytesWritten:c,buffer:m})})})},e.readv=function(r,o,...a){return typeof a[a.length-1]=="function"?n.readv(r,o,...a):new Promise((s,u)=>{n.readv(r,o,...a,(l,c,m)=>{if(l)return u(l);s({bytesRead:c,buffers:m})})})},e.writev=function(r,o,...a){return typeof a[a.length-1]=="function"?n.writev(r,o,...a):new Promise((s,u)=>{n.writev(r,o,...a,(l,c,m)=>{if(l)return u(l);s({bytesWritten:c,buffers:m})})})},typeof n.realpath.native=="function"?e.realpath.native=t(n.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")})(j);var Le={},dt={};const Pn=R;dt.checkPath=function(t){if(process.platform==="win32"&&/[<>:"|?*]/.test(t.replace(Pn.parse(t).root,""))){const i=new Error(`Path contains invalid characters: ${t}`);throw i.code="EINVAL",i}};const ht=j,{checkPath:wt}=dt,pt=e=>{const t={mode:511};return typeof e=="number"?e:{...t,...e}.mode};Le.makeDir=async(e,t)=>(wt(e),ht.mkdir(e,{mode:pt(t),recursive:!0}));Le.makeDirSync=(e,t)=>(wt(e),ht.mkdirSync(e,{mode:pt(t),recursive:!0}));const On=O.fromPromise,{makeDir:xn,makeDirSync:ke}=Le,Fe=On(xn);var J={mkdirs:Fe,mkdirsSync:ke,mkdirp:Fe,mkdirpSync:ke,ensureDir:Fe,ensureDirSync:ke};const Dn=O.fromPromise,St=j;function Cn(e){return St.access(e).then(()=>!0).catch(()=>!1)}var G={pathExists:Dn(Cn),pathExistsSync:St.existsSync};const ee=j,In=O.fromPromise;async function _n(e,t,n){const i=await ee.open(e,"r+");let r=null;try{await ee.futimes(i,t,n)}finally{try{await ee.close(i)}catch(o){r=o}}if(r)throw r}function Tn(e,t,n){const i=ee.openSync(e,"r+");return ee.futimesSync(i,t,n),ee.closeSync(i)}var vt={utimesMillis:In(_n),utimesMillisSync:Tn};const te=j,D=R,Ke=O.fromPromise;function Wn(e,t,n){const i=n.dereference?r=>te.stat(r,{bigint:!0}):r=>te.lstat(r,{bigint:!0});return Promise.all([i(e),i(t).catch(r=>{if(r.code==="ENOENT")return null;throw r})]).then(([r,o])=>({srcStat:r,destStat:o}))}function Nn(e,t,n){let i;const r=n.dereference?a=>te.statSync(a,{bigint:!0}):a=>te.lstatSync(a,{bigint:!0}),o=r(e);try{i=r(t)}catch(a){if(a.code==="ENOENT")return{srcStat:o,destStat:null};throw a}return{srcStat:o,destStat:i}}async function Ln(e,t,n,i){const{srcStat:r,destStat:o}=await Wn(e,t,i);if(o){if(me(r,o)){const a=D.basename(e),s=D.basename(t);if(n==="move"&&a!==s&&a.toLowerCase()===s.toLowerCase())return{srcStat:r,destStat:o,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(r.isDirectory()&&!o.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!r.isDirectory()&&o.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(r.isDirectory()&&Me(e,t))throw new Error(Se(e,t,n));return{srcStat:r,destStat:o}}function Mn(e,t,n,i){const{srcStat:r,destStat:o}=Nn(e,t,i);if(o){if(me(r,o)){const a=D.basename(e),s=D.basename(t);if(n==="move"&&a!==s&&a.toLowerCase()===s.toLowerCase())return{srcStat:r,destStat:o,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(r.isDirectory()&&!o.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!r.isDirectory()&&o.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(r.isDirectory()&&Me(e,t))throw new Error(Se(e,t,n));return{srcStat:r,destStat:o}}async function gt(e,t,n,i){const r=D.resolve(D.dirname(e)),o=D.resolve(D.dirname(n));if(o===r||o===D.parse(o).root)return;let a;try{a=await te.stat(o,{bigint:!0})}catch(s){if(s.code==="ENOENT")return;throw s}if(me(t,a))throw new Error(Se(e,n,i));return gt(e,t,o,i)}function $t(e,t,n,i){const r=D.resolve(D.dirname(e)),o=D.resolve(D.dirname(n));if(o===r||o===D.parse(o).root)return;let a;try{a=te.statSync(o,{bigint:!0})}catch(s){if(s.code==="ENOENT")return;throw s}if(me(t,a))throw new Error(Se(e,n,i));return $t(e,t,o,i)}function me(e,t){return t.ino&&t.dev&&t.ino===e.ino&&t.dev===e.dev}function Me(e,t){const n=D.resolve(e).split(D.sep).filter(r=>r),i=D.resolve(t).split(D.sep).filter(r=>r);return n.every((r,o)=>i[o]===r)}function Se(e,t,n){return`Cannot ${n} '${e}' to a subdirectory of itself, '${t}'.`}var ie={checkPaths:Ke(Ln),checkPathsSync:Mn,checkParentPaths:Ke(gt),checkParentPathsSync:$t,isSrcSubdir:Me,areIdentical:me};const W=j,ce=R,{mkdirs:jn}=J,{pathExists:An}=G,{utimesMillis:Rn}=vt,se=ie;async function qn(e,t,n={}){typeof n=="function"&&(n={filter:n}),n.clobber="clobber"in n?!!n.clobber:!0,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001");const{srcStat:i,destStat:r}=await se.checkPaths(e,t,"copy",n);if(await se.checkParentPaths(e,i,t,"copy"),!await bt(e,t,n))return;const a=ce.dirname(t);await An(a)||await jn(a),await Et(r,e,t,n)}async function bt(e,t,n){return n.filter?n.filter(e,t):!0}async function Et(e,t,n,i){const o=await(i.dereference?W.stat:W.lstat)(t);if(o.isDirectory())return zn(o,e,t,n,i);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return Bn(o,e,t,n,i);if(o.isSymbolicLink())return Hn(e,t,n,i);throw o.isSocket()?new Error(`Cannot copy a socket file: ${t}`):o.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${t}`):new Error(`Unknown file: ${t}`)}async function Bn(e,t,n,i,r){if(!t)return Qe(e,n,i,r);if(r.overwrite)return await W.unlink(i),Qe(e,n,i,r);if(r.errorOnExist)throw new Error(`'${i}' already exists`)}async function Qe(e,t,n,i){if(await W.copyFile(t,n),i.preserveTimestamps){Jn(e.mode)&&await Un(n,e.mode);const r=await W.stat(t);await Rn(n,r.atime,r.mtime)}return W.chmod(n,e.mode)}function Jn(e){return(e&128)===0}function Un(e,t){return W.chmod(e,t|128)}async function zn(e,t,n,i,r){t||await W.mkdir(i);const o=await W.readdir(n);await Promise.all(o.map(async a=>{const s=ce.join(n,a),u=ce.join(i,a);if(!await bt(s,u,r))return;const{destStat:c}=await se.checkPaths(s,u,"copy",r);return Et(c,s,u,r)})),t||await W.chmod(i,e.mode)}async function Hn(e,t,n,i){let r=await W.readlink(t);if(i.dereference&&(r=ce.resolve(process.cwd(),r)),!e)return W.symlink(r,n);let o=null;try{o=await W.readlink(n)}catch(a){if(a.code==="EINVAL"||a.code==="UNKNOWN")return W.symlink(r,n);throw a}if(i.dereference&&(o=ce.resolve(process.cwd(),o)),se.isSrcSubdir(r,o))throw new Error(`Cannot copy '${r}' to a subdirectory of itself, '${o}'.`);if(se.isSrcSubdir(o,r))throw new Error(`Cannot overwrite '${o}' with '${r}'.`);return await W.unlink(n),W.symlink(r,n)}var Vn=qn;const L=re,ue=R,Yn=J.mkdirsSync,Gn=vt.utimesMillisSync,le=ie;function Kn(e,t,n){typeof n=="function"&&(n={filter:n}),n=n||{},n.clobber="clobber"in n?!!n.clobber:!0,n.overwrite="overwrite"in n?!!n.overwrite:n.clobber,n.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");const{srcStat:i,destStat:r}=le.checkPathsSync(e,t,"copy",n);if(le.checkParentPathsSync(e,i,t,"copy"),n.filter&&!n.filter(e,t))return;const o=ue.dirname(t);return L.existsSync(o)||Yn(o),kt(r,e,t,n)}function kt(e,t,n,i){const o=(i.dereference?L.statSync:L.lstatSync)(t);if(o.isDirectory())return rr(o,e,t,n,i);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return Qn(o,e,t,n,i);if(o.isSymbolicLink())return ar(e,t,n,i);throw o.isSocket()?new Error(`Cannot copy a socket file: ${t}`):o.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${t}`):new Error(`Unknown file: ${t}`)}function Qn(e,t,n,i,r){return t?Xn(e,n,i,r):Ft(e,n,i,r)}function Xn(e,t,n,i){if(i.overwrite)return L.unlinkSync(n),Ft(e,t,n,i);if(i.errorOnExist)throw new Error(`'${n}' already exists`)}function Ft(e,t,n,i){return L.copyFileSync(t,n),i.preserveTimestamps&&Zn(e.mode,t,n),je(n,e.mode)}function Zn(e,t,n){return er(e)&&tr(n,e),nr(t,n)}function er(e){return(e&128)===0}function tr(e,t){return je(e,t|128)}function je(e,t){return L.chmodSync(e,t)}function nr(e,t){const n=L.statSync(e);return Gn(t,n.atime,n.mtime)}function rr(e,t,n,i,r){return t?Pt(n,i,r):ir(e.mode,n,i,r)}function ir(e,t,n,i){return L.mkdirSync(n),Pt(t,n,i),je(n,e)}function Pt(e,t,n){L.readdirSync(e).forEach(i=>or(i,e,t,n))}function or(e,t,n,i){const r=ue.join(t,e),o=ue.join(n,e);if(i.filter&&!i.filter(r,o))return;const{destStat:a}=le.checkPathsSync(r,o,"copy",i);return kt(a,r,o,i)}function ar(e,t,n,i){let r=L.readlinkSync(t);if(i.dereference&&(r=ue.resolve(process.cwd(),r)),e){let o;try{o=L.readlinkSync(n)}catch(a){if(a.code==="EINVAL"||a.code==="UNKNOWN")return L.symlinkSync(r,n);throw a}if(i.dereference&&(o=ue.resolve(process.cwd(),o)),le.isSrcSubdir(r,o))throw new Error(`Cannot copy '${r}' to a subdirectory of itself, '${o}'.`);if(le.isSrcSubdir(o,r))throw new Error(`Cannot overwrite '${o}' with '${r}'.`);return cr(r,n)}else return L.symlinkSync(r,n)}function cr(e,t){return L.unlinkSync(t),L.symlinkSync(e,t)}var sr=Kn;const ur=O.fromPromise;var Ae={copy:ur(Vn),copySync:sr};const Ot=re,lr=O.fromCallback;function fr(e,t){Ot.rm(e,{recursive:!0,force:!0},t)}function mr(e){Ot.rmSync(e,{recursive:!0,force:!0})}var ve={remove:lr(fr),removeSync:mr};const yr=O.fromPromise,xt=j,Dt=R,Ct=J,It=ve,Xe=yr(async function(t){let n;try{n=await xt.readdir(t)}catch{return Ct.mkdirs(t)}return Promise.all(n.map(i=>It.remove(Dt.join(t,i))))});function Ze(e){let t;try{t=xt.readdirSync(e)}catch{return Ct.mkdirsSync(e)}t.forEach(n=>{n=Dt.join(e,n),It.removeSync(n)})}var dr={emptyDirSync:Ze,emptydirSync:Ze,emptyDir:Xe,emptydir:Xe};const hr=O.fromPromise,_t=R,U=j,Tt=J;async function wr(e){let t;try{t=await U.stat(e)}catch{}if(t&&t.isFile())return;const n=_t.dirname(e);let i=null;try{i=await U.stat(n)}catch(r){if(r.code==="ENOENT"){await Tt.mkdirs(n),await U.writeFile(e,"");return}else throw r}i.isDirectory()?await U.writeFile(e,""):await U.readdir(n)}function pr(e){let t;try{t=U.statSync(e)}catch{}if(t&&t.isFile())return;const n=_t.dirname(e);try{U.statSync(n).isDirectory()||U.readdirSync(n)}catch(i){if(i&&i.code==="ENOENT")Tt.mkdirsSync(n);else throw i}U.writeFileSync(e,"")}var Sr={createFile:hr(wr),createFileSync:pr};const vr=O.fromPromise,Wt=R,H=j,Nt=J,{pathExists:gr}=G,{areIdentical:Lt}=ie;async function $r(e,t){let n;try{n=await H.lstat(t)}catch{}let i;try{i=await H.lstat(e)}catch(a){throw a.message=a.message.replace("lstat","ensureLink"),a}if(n&&Lt(i,n))return;const r=Wt.dirname(t);await gr(r)||await Nt.mkdirs(r),await H.link(e,t)}function br(e,t){let n;try{n=H.lstatSync(t)}catch{}try{const o=H.lstatSync(e);if(n&&Lt(o,n))return}catch(o){throw o.message=o.message.replace("lstat","ensureLink"),o}const i=Wt.dirname(t);return H.existsSync(i)||Nt.mkdirsSync(i),H.linkSync(e,t)}var Er={createLink:vr($r),createLinkSync:br};const V=R,ae=j,{pathExists:kr}=G,Fr=O.fromPromise;async function Pr(e,t){if(V.isAbsolute(e)){try{await ae.lstat(e)}catch(o){throw o.message=o.message.replace("lstat","ensureSymlink"),o}return{toCwd:e,toDst:e}}const n=V.dirname(t),i=V.join(n,e);if(await kr(i))return{toCwd:i,toDst:e};try{await ae.lstat(e)}catch(o){throw o.message=o.message.replace("lstat","ensureSymlink"),o}return{toCwd:e,toDst:V.relative(n,e)}}function Or(e,t){if(V.isAbsolute(e)){if(!ae.existsSync(e))throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}const n=V.dirname(t),i=V.join(n,e);if(ae.existsSync(i))return{toCwd:i,toDst:e};if(!ae.existsSync(e))throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:V.relative(n,e)}}var xr={symlinkPaths:Fr(Pr),symlinkPathsSync:Or};const Mt=j,Dr=O.fromPromise;async function Cr(e,t){if(t)return t;let n;try{n=await Mt.lstat(e)}catch{return"file"}return n&&n.isDirectory()?"dir":"file"}function Ir(e,t){if(t)return t;let n;try{n=Mt.lstatSync(e)}catch{return"file"}return n&&n.isDirectory()?"dir":"file"}var _r={symlinkType:Dr(Cr),symlinkTypeSync:Ir};const Tr=O.fromPromise,jt=R,B=j,{mkdirs:Wr,mkdirsSync:Nr}=J,{symlinkPaths:Lr,symlinkPathsSync:Mr}=xr,{symlinkType:jr,symlinkTypeSync:Ar}=_r,{pathExists:Rr}=G,{areIdentical:At}=ie;async function qr(e,t,n){let i;try{i=await B.lstat(t)}catch{}if(i&&i.isSymbolicLink()){const[s,u]=await Promise.all([B.stat(e),B.stat(t)]);if(At(s,u))return}const r=await Lr(e,t);e=r.toDst;const o=await jr(r.toCwd,n),a=jt.dirname(t);return await Rr(a)||await Wr(a),B.symlink(e,t,o)}function Br(e,t,n){let i;try{i=B.lstatSync(t)}catch{}if(i&&i.isSymbolicLink()){const s=B.statSync(e),u=B.statSync(t);if(At(s,u))return}const r=Mr(e,t);e=r.toDst,n=Ar(r.toCwd,n);const o=jt.dirname(t);return B.existsSync(o)||Nr(o),B.symlinkSync(e,t,n)}var Jr={createSymlink:Tr(qr),createSymlinkSync:Br};const{createFile:et,createFileSync:tt}=Sr,{createLink:nt,createLinkSync:rt}=Er,{createSymlink:it,createSymlinkSync:ot}=Jr;var Ur={createFile:et,createFileSync:tt,ensureFile:et,ensureFileSync:tt,createLink:nt,createLinkSync:rt,ensureLink:nt,ensureLinkSync:rt,createSymlink:it,createSymlinkSync:ot,ensureSymlink:it,ensureSymlinkSync:ot};function zr(e,{EOL:t=`
`,finalEOL:n=!0,replacer:i=null,spaces:r}={}){const o=n?t:"";return JSON.stringify(e,i,r).replace(/\n/g,t)+o}function Hr(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e.replace(/^\uFEFF/,"")}var Re={stringify:zr,stripBom:Hr};let ne;try{ne=re}catch{ne=lt}const ge=O,{stringify:Rt,stripBom:qt}=Re;async function Vr(e,t={}){typeof t=="string"&&(t={encoding:t});const n=t.fs||ne,i="throws"in t?t.throws:!0;let r=await ge.fromCallback(n.readFile)(e,t);r=qt(r);let o;try{o=JSON.parse(r,t?t.reviver:null)}catch(a){if(i)throw a.message=`${e}: ${a.message}`,a;return null}return o}const Yr=ge.fromPromise(Vr);function Gr(e,t={}){typeof t=="string"&&(t={encoding:t});const n=t.fs||ne,i="throws"in t?t.throws:!0;try{let r=n.readFileSync(e,t);return r=qt(r),JSON.parse(r,t.reviver)}catch(r){if(i)throw r.message=`${e}: ${r.message}`,r;return null}}async function Kr(e,t,n={}){const i=n.fs||ne,r=Rt(t,n);await ge.fromCallback(i.writeFile)(e,r,n)}const Qr=ge.fromPromise(Kr);function Xr(e,t,n={}){const i=n.fs||ne,r=Rt(t,n);return i.writeFileSync(e,r,n)}const Zr={readFile:Yr,readFileSync:Gr,writeFile:Qr,writeFileSync:Xr};var ei=Zr;const he=ei;var ti={readJson:he.readFile,readJsonSync:he.readFileSync,writeJson:he.writeFile,writeJsonSync:he.writeFileSync};const ni=O.fromPromise,De=j,Bt=R,Jt=J,ri=G.pathExists;async function ii(e,t,n="utf-8"){const i=Bt.dirname(e);return await ri(i)||await Jt.mkdirs(i),De.writeFile(e,t,n)}function oi(e,...t){const n=Bt.dirname(e);De.existsSync(n)||Jt.mkdirsSync(n),De.writeFileSync(e,...t)}var qe={outputFile:ni(ii),outputFileSync:oi};const{stringify:ai}=Re,{outputFile:ci}=qe;async function si(e,t,n={}){const i=ai(t,n);await ci(e,i,n)}var ui=si;const{stringify:li}=Re,{outputFileSync:fi}=qe;function mi(e,t,n){const i=li(t,n);fi(e,i,n)}var yi=mi;const di=O.fromPromise,M=ti;M.outputJson=di(ui);M.outputJsonSync=yi;M.outputJSON=M.outputJson;M.outputJSONSync=M.outputJsonSync;M.writeJSON=M.writeJson;M.writeJSONSync=M.writeJsonSync;M.readJSON=M.readJson;M.readJSONSync=M.readJsonSync;var hi=M;const wi=j,at=R,{copy:pi}=Ae,{remove:Ut}=ve,{mkdirp:Si}=J,{pathExists:vi}=G,ct=ie;async function gi(e,t,n={}){const i=n.overwrite||n.clobber||!1,{srcStat:r,isChangingCase:o=!1}=await ct.checkPaths(e,t,"move",n);await ct.checkParentPaths(e,r,t,"move");const a=at.dirname(t);return at.parse(a).root!==a&&await Si(a),$i(e,t,i,o)}async function $i(e,t,n,i){if(!i){if(n)await Ut(t);else if(await vi(t))throw new Error("dest already exists.")}try{await wi.rename(e,t)}catch(r){if(r.code!=="EXDEV")throw r;await bi(e,t,n)}}async function bi(e,t,n){return await pi(e,t,{overwrite:n,errorOnExist:!0,preserveTimestamps:!0}),Ut(e)}var Ei=gi;const zt=re,Ce=R,ki=Ae.copySync,Ht=ve.removeSync,Fi=J.mkdirpSync,st=ie;function Pi(e,t,n){n=n||{};const i=n.overwrite||n.clobber||!1,{srcStat:r,isChangingCase:o=!1}=st.checkPathsSync(e,t,"move",n);return st.checkParentPathsSync(e,r,t,"move"),Oi(t)||Fi(Ce.dirname(t)),xi(e,t,i,o)}function Oi(e){const t=Ce.dirname(e);return Ce.parse(t).root===t}function xi(e,t,n,i){if(i)return Pe(e,t,n);if(n)return Ht(t),Pe(e,t,n);if(zt.existsSync(t))throw new Error("dest already exists.");return Pe(e,t,n)}function Pe(e,t,n){try{zt.renameSync(e,t)}catch(i){if(i.code!=="EXDEV")throw i;return Di(e,t,n)}}function Di(e,t,n){return ki(e,t,{overwrite:n,errorOnExist:!0,preserveTimestamps:!0}),Ht(e)}var Ci=Pi;const Ii=O.fromPromise;var _i={move:Ii(Ei),moveSync:Ci},Ti={...j,...Ae,...dr,...Ur,...hi,...J,..._i,...qe,...G,...ve};const Wi=e=>Ti.readJsonSync(R.join(__dirname,`../../dist/shortcuts/${e}`)),Ni=async()=>{Z.ipcMain.handle("get-shortcut",async(e,t)=>await Wi(t))},{ipcMain:Li}=require("electron"),X=require("fs-extra"),Mi=require("@ffmpeg-installer/ffmpeg").path,ji=require("@ffprobe-installer/ffprobe").path,Be=require("fluent-ffmpeg"),Oe=require("path");Be.setFfmpegPath(Mi);Be.setFfprobePath(ji);const Ai=async(e,t,n,i)=>new Promise((r,o)=>{Be(e).on("end",()=>{r(!0),console.info("screeshot ok")}).on("error",a=>{console.info("error ->",a),o(a)}).screenshots({timestamps:t,filename:"temp_%i.png",folder:n,size:`${i}`})}),Ri=async()=>{Li.handle("get-video-frame-data",async(e,t,n,i,r,o,a,...s)=>{const u=Oe.join(__dirname,"../../temp");X.existsSync(u)||X.mkdirSync(u);const l=qi(r,o);if(!await Ai(t,l,u,`${n}x${i}`)){console.info("video frame error");return}let m=[];const y=X.readdirSync(u,{withFileTypes:!0});for(let f of y){try{const g=X.readFileSync(Oe.join(u,f.name)).toString("base64"),S=await mt.generate(g,a,s);m.push(S)}catch(d){return console.error("Error reading image:",d),null}X.unlinkSync(Oe.join(u,f.name))}return X.rmdir(u),m})},qi=(e,t)=>{let n=1/t,i=[];for(let r=0;r<e;r++)for(let o=0;o<t;o++)i.push(String((r+n*o).toFixed(2)));return i},{dialog:Bi}=require("electron");require("path");const Ji=async()=>await Bi.showOpenDialog({title:"选择一个文件",buttonLabel:"确认选择",properties:["openFile"],filters:[{name:"视频资源",extensions:["mp4","avi","mkv","mov","flv","wmv","webm","mpeg","mpg","ogv","3gp","m4v","asf","rm","rmvb","ts"]}]}),{app:fe,protocol:Ui,BrowserWindow:Ie,ipcMain:K,shell:zi}=require("electron");require("path");Xt();cn();Ni();Ri();K.on("set-item",(e,t,n)=>{un(t,n)});K.on("del-item",(e,t)=>{fn(t)});K.handle("get-item",async(e,t)=>await ln(t));K.on("latest-download",(e,t)=>{zi.openExternal(t)});K.on("window-create",(e,t,n)=>{new ft().createWindow(t,n)});K.handle("select-video-file",async()=>await Ji());K.on("store-set",(e,t)=>{for(const n of Ie.getAllWindows())n!=Ie.fromWebContents(e.sender)&&n.webContents.send("store-get",t)});const ut=async()=>{new ft().createWindow({route:"/home",isMainWin:!0},{width:999,height:773,minWidth:688,minHeight:560})};fe.commandLine.appendSwitch("--ignore-certificate-errors","true");Ui.registerSchemesAsPrivileged([{scheme:"app",privileges:{secure:!0,standard:!0}}]);fe.whenReady().then(async()=>{ut(),fe.on("activate",()=>{Ie.getAllWindows().length===0&&ut()})});fe.on("window-all-closed",()=>{process.platform!=="darwin"&&fe.quit()});
